<!-- FILTER -->
<form method="get">
<div style="display:flex; flex-direction:column; justify-content:center; align-items:flex-start; margin-bottom: 40px;">
        <h4>Search</h4>
        <div style="display: flex; flex-direction: row; justify-content: flex-start;">
            <input class="searchEngine" value="<?= $params->comment ?>" style="width:400px;" type="text" name="comment" placeholder="Search by dataset comment" id="compoundSearch"><button type="submit" class="btn btn-sm btn-success">Search / Submit filters</button>
        </div>
    </div>
</form>
<div style="display:flex; flex-direction: row; justify-content: space-between;">
    <div style="width: 600px;">
        <strong>Running jobs:</strong> <?= Config::get(Configs::COSMO_TOTAL_RUNNING) . "/" . Config::get(Configs::COSMO_METACENTRUM_MAX_RUNNING) ?> (<strong>Last update:</strong> <?= Config::get(Configs::COSMO_LAST_UPDATE) ? date("d/m/Y H:i", strtotime(Config::get(Configs::COSMO_LAST_UPDATE))) : "Never" ?>)
    </div>

    <div class="action-bar">
        <div>
            <button class="btn btn-sm btn-info"><a href="/validator/add_cosmo_smi"> Add new dataset</a></button>
        </div>
    </div>
</div>

 <div class="tab_detail" id="tab_transporters">
    <h3 style="text-align: center;"><b>Cosmo datasets</b> (<?= $total ?>)</h3>
    <table class="table table-striped">
        <thead>
            <tr>
                <td>ID</td>
                <td>Comment</td>
                <td>Author</td>
                <td>Total compounds</td>
                <td>Stats (<span style="color: blue;">pending</span>/<span style="color: #bf5600;">running</span>/<span style="color: green;">done</span>/<span style="color: red;">errors</span>)</td>
                <td>Last update</td>
                <td>Upload date</td>
                <td>Actions</td>
            </tr>
        </thead>
        <tbody>
            <?php foreach($datasets as $d): ?>
            <tr>
                <td><?= $d->id ?></td>
                <td><?= $d->comment ?></td>
                <td><?= $d->author ?></td>
                <td><?= $d->total_runs ?></td>
                <td><?= '<span style="color: blue;">' . $d->total_pending . "</span>/<span style=\"color: #bf5600;\">" . $d->total_running . '</span>/<span style="color: green;">' . $d->total_done . "</span>/<span style=\"color: red;\">" . $d->total_error . '</span>' ?></td>
                <td><?= $d->last_update != NULL ? date("d. m. Y", strtotime($d->last_update)) : 'Unknown' ?></td>
                <td><?= $d->create_date != NULL ? date("d. m. Y", strtotime($d->create_date)) : 'Unknown' ?></td>
                <td>
                    <a href="/validator/cosmo/<?= $d->id ?>" title="Detail"><span style="cursor:pointer;" class="glyphicon glyphicon-eye-open"></span></a>
                    <a href="/validator/edit_cosmo_dataset/<?= $d->id ?>" title="Edit comment"><span style="cursor:pointer;" class="glyphicon glyphicon-edit"></span></a>
                </td>
            </tr>
            <?php endforeach ?>
        </tbody>
    </table>
 </div>
